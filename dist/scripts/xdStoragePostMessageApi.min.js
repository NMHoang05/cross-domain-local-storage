var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[f]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var f=0;return $jscomp.iteratorPrototype(function(){return f<b.length?{done:!1,value:b[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(b,f){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var d=0,g={next:function(){if(d<b.length){var h=d++;return{value:f(h,b[h]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(b,f,d,g){if(f){d=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var h=b[g];h in d||(d[h]={});d=d[h]}b=b[b.length-1];g=d[b];f=f(g);f!=g&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6-impl","es3");
(function(){function b(b,a){var c=XdUtils.extend(a,g);c.id=b;parent.postMessage(JSON.stringify(c),"*")}function f(b){var a;try{a=JSON.parse(b.data)}catch(e){}a&&"cross-domain-local-message"===a.namespace&&("local"==a.type&&("set"===a.action?m.setData(a.id,a.key,a.value):"get"===a.action?m.getData(a.id,a.key):"remove"===a.action?m.removeData(a.id,a.key):"key"===a.action?m.getKey(a.id,a.key):"size"===a.action?m.getSize(a.id):"length"===a.action?m.getLength(a.id):"clear"===a.action&&m.clear(a.id)),"session"==
a.type&&("set"===a.action?k.setData(a.id,a.key,a.value):"get"===a.action?k.getData(a.id,a.key):"remove"===a.action?k.removeData(a.id,a.key):"key"===a.action?k.getKey(a.id,a.key):"size"===a.action?k.getSize(a.id):"length"===a.action?k.getLength(a.id):"clear"===a.action?k.clear(a.id):"sync"===a.action?k.syncManual(a.id,a.key):"option"===a.action&&"auto-sync"==a.key&&(h=a.value)))}function d(c){if(null!=c.newValue&&"cross-domain-storage-sync"==c.key){var a;try{a=JSON.parse(c.newValue)}catch(p){return}if("request"==
a.type){var e=[];if(null==a.keys||"string"!=typeof a.keys||0==a.keys.trim().length)for(c=0;c<sessionStorage.length;c++)e.push(sessionStorage.key(c));else e=JSON.parse(a.keys);a={type:"response",id:a.id,keys:e,hash:{}};for(c=0;c<e.length;c++)a.hash[e[c]]=sessionStorage.getItem(e[c]);localStorage.setItem("cross-domain-storage-sync",JSON.stringify(a));localStorage.removeItem("cross-domain-storage-sync")}else if("response"==a.type)if(a.keys&&a.keys.length){for(c=0;c<a.keys.length;c++)null==a.hash[a.keys[c]]?
sessionStorage.removeItem(a.keys[c]):sessionStorage.setItem(a.keys[c],a.hash[a.keys[c]]);a.id&&(0==n&&(n=(new Date).getTime()),l[a.id]&&(clearTimeout(l[a.id]),delete l[a.id]),b(a.id,{status:0,message:"sync completed"}))}else a.id&&(0==n&&(n=(new Date).getTime()),l[a.id]&&(clearTimeout(l[a.id]),delete l[a.id]),b(a.id,{status:2,message:"nothing to sync  "+JSON.stringify(a)}))}}var g={namespace:"cross-domain-local-message"},h=!1,n=0,l={},m={getData:function(c,a){var e=localStorage.getItem(a);b(c,{key:a,
value:e})},setData:function(c,a,e){localStorage.setItem(a,e);a={success:localStorage.getItem(a)===e};b(c,a)},removeData:function(c,a){localStorage.removeItem(a);b(c,{})},getKey:function(c,a){var e=localStorage.key(a);b(c,{key:e})},getSize:function(c){var a=JSON.stringify(localStorage).length;b(c,{size:a})},getLength:function(c){b(c,{length:localStorage.length})},clear:function(c){localStorage.clear();b(c,{})}},k={getData:function(c,a){var e=sessionStorage.getItem(a);b(c,{key:a,value:e})},setData:function(c,
a,e){sessionStorage.setItem(a,e);var d={success:sessionStorage.getItem(a)===e};h&&d.success&&k.syncAuto(a,e);b(c,d)},removeData:function(c,a){sessionStorage.removeItem(a);h&&k.syncAuto(a,null);b(c,{})},getKey:function(c,a){var e=sessionStorage.key(a);b(c,{key:e})},getSize:function(c){var a=JSON.stringify(sessionStorage).length;b(c,{size:a})},getLength:function(c){b(c,{length:sessionStorage.length})},clear:function(c){h&&k.syncAuto(null,null);sessionStorage.clear();b(c,{})},syncManual:function(c,a){var e=
{type:"request",id:c,keys:a,time:(new Date).getTime()};try{localStorage.setItem("cross-domain-storage-sync",JSON.stringify(e)),localStorage.removeItem("cross-domain-storage-sync")}catch(p){b(c,{status:1,message:p});return}l[c]=setTimeout(function(){delete l[c];b(c,{status:1,message:"timed out"})},1E3)},syncAuto:function(b,a){var c,d={type:"response",id:null,keys:[],hash:{}};if(null!=b)d.keys.push(b),d.hash[b]=a;else{var f;for(c=0;c<sessionStorage.length;c++)f=sessionStorage.key(c),d.keys.push(f),
d.hash[f]=sessionStorage.getItem(f)}localStorage.setItem("cross-domain-storage-sync",JSON.stringify(d));localStorage.removeItem("cross-domain-storage-sync")}};window.addEventListener?(window.addEventListener("message",f,!1),window.addEventListener("storage",d,!1)):(window.attachEvent("onmessage",f),window.attachEvent("onstorage",d));parent.postMessage(JSON.stringify({namespace:"cross-domain-local-message",id:"iframe-ready"}),"*")})();

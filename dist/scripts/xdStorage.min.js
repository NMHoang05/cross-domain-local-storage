window.xdStorage=window.xdStorage||function(){function q(a){null==a.id?"function"==typeof e.sessionSyncNotify&&e.sessionSyncNotify(a):f[a.id]&&(f[a.id](a),delete f[a.id])}function l(a){var b;try{b=JSON.parse(a.data)}catch(r){return}b&&"cross-domain-local-message"===b.namespace&&("iframe-ready"===b.id?(m=!0,e.sessionAutoSync&&c("session","option","auto-sync",!0,function(){c("session","sync","",null,null)}),e.initCallback()):(b.normal_response||console.log("Error: "+b.error),q(b)))}function c(a,b,c,
d,e){h++;f[h]=e;a={namespace:"cross-domain-local-message",id:h,type:a,action:b,key:c,value:d};(b=Array.prototype.toJSON)?(delete Array.prototype.toJSON,k.contentWindow.postMessage(JSON.stringify(a),"*"),Array.prototype.toJSON=b):k.contentWindow.postMessage(JSON.stringify(a),"*")}function n(a){e=XdUtils.extend(a,e);a=document.createElement("div");window.addEventListener?window.addEventListener("message",l,!1):window.attachEvent("onmessage",l);a.innerHTML='<iframe id="'+e.iframeId+'" src='+e.iframeUrl+
' style="display: none;"></iframe>';document.body.appendChild(a);k=document.getElementById(e.iframeId)}function d(){return g?m?!0:(console.log("You must wait for iframe ready message before using the api."),!1):(console.log("You must call xdStorage.init() before using it."),!1)}var e={iframeId:"cross-domain-iframe",iframeUrl:void 0,sessionAutoSync:!1,initCallback:function(){},sessionSyncNotify:null},h=-1,k,f={},g=!1,p=!1,m=!1;return{init:function(a){if(!a.iframeUrl)throw"You must specify iframeUrl";
g?console.log("xdStorage was already initialized!"):(g=!0,"complete"===document.readyState?n(a):function(a){function b(){c||(c=!0,n(a))}var c=!1;document.addEventListener?(document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",b,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",b),window.attachEvent("onload",b))}(a))},version:"3.0.13",wasInit:function(){return g},autoSync:function(a){if(null==a)return p;p=a;c("session","option","auto-sync",a,null)},local:{setItem:function(a,
b,e){d()&&c("local","set",a,b,e)},getItem:function(a,b){d()&&c("local","get",a,null,b)},removeItem:function(a,b){d()&&c("local","remove",a,null,b)},key:function(a,b){d()&&c("local","key",a,null,b)},getSize:function(a){d()&&c("local","size",null,null,a)},getLength:function(a){d()&&c("local","length",null,null,a)},clear:function(a){d()&&c("local","clear",null,null,a)}},session:{setItem:function(a,b,e){d()&&c("session","set",a,b,e)},getItem:function(a,b){d()&&c("session","get",a,null,b)},removeItem:function(a,
b){d()&&c("session","remove",a,null,b)},key:function(a,b){d()&&c("session","key",a,null,b)},getSize:function(a){d()&&c("session","size",null,null,a)},getLength:function(a){d()&&c("session","length",null,null,a)},clear:function(a){d()&&c("session","clear",null,null,a)},sync:function(a,b){d()&&c("session","sync",a,null,b)}}}}();

window.xdStorage=window.xdStorage||function(){function k(a){var b;try{b=JSON.parse(a.data)}catch(p){}b&&"cross-domain-local-message"===b.namespace&&("iframe-ready"===b.id?(l=!0,e.initCallback()):(a=b,f[a.id]&&(f[a.id](a),delete f[a.id])))}function c(a,b,c,d,e){h++;f[h]=e;m.contentWindow.postMessage(JSON.stringify({namespace:"cross-domain-local-message",id:h,type:a,action:b,key:c,value:d}),"*")}function n(a){e=XdUtils.extend(a,e);a=document.createElement("div");window.addEventListener?window.addEventListener("message",
k,!1):window.attachEvent("onmessage",k);a.innerHTML='<iframe id="'+e.iframeId+'" src='+e.iframeUrl+' style="display: none;"></iframe>';document.body.appendChild(a);m=document.getElementById(e.iframeId)}function d(){return g?l?!0:(console.log("You must wait for iframe ready message before using the api."),!1):(console.log("You must call xdLocalStorage.init() before using it."),!1)}var e={iframeId:"cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},h=-1,m,f={},g=!1,l=!0;return{init:function(a){if(!a.iframeUrl)throw"You must specify iframeUrl";
g?console.log("xdLocalStorage was already initialized!"):(g=!0,"complete"===document.readyState?n(a):window.onload=function(){n(a)})},wasInit:function(){return g},local:{setItem:function(a,b,e){d()&&c("local","set",a,b,e)},getItem:function(a,b){d()&&c("local","get",a,null,b)},removeItem:function(a,b){d()&&c("local","remove",a,null,b)},key:function(a,b){d()&&c("local","key",a,null,b)},getSize:function(a){d()&&c("local","size",null,null,a)},getLength:function(a){d()&&c("local","length",null,null,a)},
clear:function(a){d()&&c("local","clear",null,null,a)}},session:{setItem:function(a,b,e){d()&&c("session","set",a,b,e)},getItem:function(a,b){d()&&c("session","get",a,null,b)},removeItem:function(a,b){d()&&c("session","remove",a,null,b)},key:function(a,b){d()&&c("session","key",a,null,b)},getSize:function(a){d()&&c("session","size",null,null,a)},getLength:function(a){d()&&c("session","length",null,null,a)},clear:function(a){d()&&c("session","clear",null,null,a)}}}}();

angular.module("xdStorage",[]).service("xdStorage",["$q","$rootScope",function(d,e){function b(a){var b=Array.prototype.slice.call(arguments,1);if(!xdStorage.wasInit())throw"You must init xdStorage in app config before use";return f.promise.then(function(){var c=d.defer();xdStorage[a].apply(this,b.concat(function(a){e.$apply(function(){c.resolve(a)})}));return c.promise})}var g=!1,f=d.defer(),h=e.$watch(function(){return g},function(){f.resolve(!0);h()});return{init:function(a){var b=d.defer();a.initCallback=
function(){e.$apply(function(){g=!0;b.resolve()})};xdStorage.init(a);return b.promise},version:xdStorage.version,local:{setItem:function(a,c){return b("local","setItem",a,c)},getItem:function(a){return b("local","getItem",a)},removeItem:function(a){return b("local","removeItem",a)},key:function(a){return b("local","key",a)},clear:function(){return b("local","clear")}},session:{setItem:function(a,c){return b("session","setItem",a,c)},getItem:function(a){return b("session","getItem",a)},removeItem:function(a){return b("session",
"removeItem",a)},key:function(a){return b("session","key",a)},clear:function(){return b("session","clear")},sync:function(){return b("session","sync")}}}}]);
